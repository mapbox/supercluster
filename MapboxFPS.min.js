!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("MapboxFPS",[],t):"object"==typeof exports?exports.MapboxFPS=t():e.MapboxFPS=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={max:function(e){return Math.max.apply(null,e)},min:function(e){return Math.min.apply(null,e)},range:function(e){return r.max(e)-r.min(e)},midrange:function(e){return r.range(e)/2},sum:function(e){for(var t=0,n=0,r=e.length;n<r;n++)t+=e[n];return t},mean:function(e){return r.sum(e)/e.length},median:function(e){e.sort(function(e,t){return e-t});var t=e.length/2;return t%1?e[t-.5]:(e[t-1]+e[t])/2},modes:function(e){if(!e.length)return[];var t={},n=0,r=[];return e.forEach(function(e){t[e]?t[e]++:t[e]=1,t[e]>n?(r=[e],n=t[e]):t[e]===n&&(r.push(e),n=t[e])}),r},variance:function(e){var t=r.mean(e);return r.mean(e.map(function(e){return Math.pow(e-t,2)}))},standardDeviation:function(e){return Math.sqrt(r.variance(e))},meanAbsoluteDeviation:function(e){var t=r.mean(e);return r.mean(e.map(function(e){return Math.abs(e-t)}))},zScores:function(e){var t=r.mean(e),n=r.standardDeviation(e);return e.map(function(e){return(e-t)/n})}};r.average=r.mean,t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.FPSControl=t.FPSMeasurer=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=function(){return window&&window.performance?window.performance.now():Date.now()},o=t.FPSMeasurer=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.options=t,this.framesCounter=0,this.lastFPSTimestamp=null,this.lastFPSMeasure=0,this.measurements=[],this.lastMeasurementTimestamp=null,this.started=!1}return a(e,[{key:"startMeasuring",value:function(e){this.started=!0,this.updateFPS(),e&&!isNaN(e)&&e>0&&setTimeout(this.stopMeasuring.bind(this),e)}},{key:"stopMeasuring",value:function(){this.started=!1}},{key:"registerRenderFrame",value:function(){this.started&&(this.framesCounter++,this.updateFPS())}},{key:"getLastMeasurement",value:function(){return this.measurements.length?this.measurements[this.measurements.length-1]:0}},{key:"updateFPS",value:function(){null===this.lastFPSTimestamp&&(this.lastFPSTimestamp=s());var e=s(),t=e-this.lastFPSTimestamp;if(t>500){var n=Math.round(this.framesCounter/(t/1e3)*10)/10;this.lastFPSTimestamp=e,this.framesCounter=0,this.recordMeasurement(n,t)}}},{key:"recordMeasurement",value:function(e,t){this.measurements.push(e)}},{key:"getMeasurements",value:function(){return this.measurements.slice()}},{key:"getMeasurementsReport",value:function(){var e=this.getMeasurements();return{measurements:e,median:Number(u.median(e).toFixed(1)),average:Number(u.average(e).toFixed(1)),variance:Number(u.variance(e).toFixed(1)),stdDev:Number(u.standardDeviation(e).toFixed(1))}}}]),e}();t.FPSControl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{className:"fps-control"};r(this,e),this.measurer=new o,this.options=t,this.countRenderBound=this.measurer.registerRenderFrame.bind(this.measurer),this.updateFPSCounterBound=this.updateFPSCounter.bind(this),this.lastFPSMeasure=null}return a(e,[{key:"updateFPSCounter",value:function(){var e=this.measurer.getLastMeasurement();e!==this.lastFPSMeasure&&(this._container.innerHTML=e.toFixed(1))}},{key:"onAdd",value:function(e){return this._map=e,this._container=document.createElement("div"),this._container.className=this.options.className+" mapboxgl-ctrl-group mapboxgl-ctrl",this.addEventListeners(),this.measurer.startMeasuring(),this._container}},{key:"remove",value:function(){this.onRemove()}},{key:"onRemove",value:function(){this.removeEventListeners(),this.measurer.stopMeasuring(),this._container.remove()}},{key:"addEventListeners",value:function(){this._map.on("render",this.countRenderBound),this._map.on("render",this.updateFPSCounterBound)}},{key:"removeEventListeners",value:function(){this._map.off("render",this.countRenderBound),this._map.off("render",this.updateFPSCounterBound)}}]),e}()}])});